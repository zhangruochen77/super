{"ast":null,"code":"import PersonOrder from \"@/api/dispatcher/PersonOrder\";\nexport default {\n  name: \"PersonOrder\",\n\n  data() {\n    return {\n      orders: [],\n      // 订单信息\n      page: 1,\n      limit: 5,\n      total: 0,\n      multipleSelection: [],\n      isMultiple: false\n    };\n  },\n\n  created() {\n    this.pageFindDispatcherOrder();\n  },\n\n  methods: {\n    pageFindDispatcherOrder() {\n      // 分页查找用户新创建的订单\n      PersonOrder.pageDisDispatcherOrder(this.page, this.limit).then(resp => {\n        if (resp.data.code === 200) {\n          this.orders = resp.data.data.data;\n          this.total = resp.data.data.total;\n        }\n      });\n    },\n\n    handleSizeChange(limit) {\n      // 每页数量改变\n      this.limit = limit;\n      this.pageFindDispatcherOrder();\n    },\n\n    handleCurrentChange(page) {\n      // 页数改变\n      this.page = page;\n      this.pageFindDispatcherOrder();\n    },\n\n    handleSelectionChange(val) {\n      // 多选操作\n      this.multipleSelection = [];\n      val.forEach(item => {\n        this.multipleSelection.push(item.id);\n      });\n      this.isMultiple = this.multipleSelection.length > 0;\n    },\n\n    orderDetermine(id) {\n      // 单个接单\n      OrderPlat.orderReceive(id).then(resp => {\n        if (resp.data.code === 200) {\n          this.$message.success('接单成功!');\n          this.pageFindDispatcherOrder();\n          return;\n        }\n\n        this.$message.warning('接单失败，当前订单已经被其他派送员选取了');\n        this.pageFindDispatcherOrder();\n      });\n    },\n\n    multipleOrderDetermine() {\n      // 一次确认多个订单送达\n      this.$confirm('此操作将一次接收' + this.multipleSelection.length + '个订单,是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        // 处理下单操作\n        OrderPlat.listOrderReceive(this.multipleSelection).then(resp => {\n          if (resp.data.code === 200) {\n            this.$message.success(resp.data.msg);\n            this.pageFindDispatcherOrder();\n            return;\n          }\n\n          this.$message.error(resp.data.msg); // 没有下单成功\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消接单'\n        });\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAiFA;AAEA;EACAA,mBADA;;EAEAC;IACA;MACAC,UADA;MACA;MACAC,OAFA;MAGAC,QAHA;MAIAC,QAJA;MAKAC,qBALA;MAMAC;IANA;EAQA,CAXA;;EAYAC;IACA;EACA,CAdA;;EAcAC;IACAC;MAAA;MACAC;QACA;UACA;UACA;QACA;MACA,CALA;IAMA,CARA;;IASAC;MAAA;MACA;MACA;IACA,CAZA;;IAaAC;MAAA;MACA;MACA;IACA,CAhBA;;IAiBAC;MAAA;MACA;MACAC;QACA;MACA,CAFA;MAGA;IACA,CAvBA;;IAwBAC;MAAA;MACAC;QACA;UACA;UACA;UACA;QACA;;QAEA;QACA;MACA,CATA;IAUA,CAnCA;;IAoCAC;MAAA;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA;QACA;QACAL;UACA;YACA;YACA;YACA;UACA;;UAEA,mCAPA,CAOA;QACA,CARA;MASA,CAfA,EAeAM,KAfA,CAeA;QACA;UACAF,YADA;UAEAG;QAFA;MAIA,CApBA;IAqBA;;EA1DA;AAdA","names":["name","data","orders","page","limit","total","multipleSelection","isMultiple","created","methods","pageFindDispatcherOrder","PersonOrder","handleSizeChange","handleCurrentChange","handleSelectionChange","val","orderDetermine","OrderPlat","multipleOrderDetermine","confirmButtonText","cancelButtonText","type","then","catch","message"],"sourceRoot":"src/views/dispatcher","sources":["PersonOrder.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <div style=\"height: 60px\">\r\n            <div style=\"float:left;\">\r\n                <el-pagination\r\n                        @size-change=\"handleSizeChange\"\r\n                        @current-change=\"handleCurrentChange\"\r\n                        :page-sizes=\"[5, 10, 20, 40]\"\r\n                        :page-size=\"limit\"\r\n                        layout=\"total, sizes, prev, pager, next, jumper\"\r\n                        :total=\"total\">\r\n                </el-pagination>\r\n            </div>\r\n            <div style=\"float: left; padding-left: 60px\">\r\n                <el-button v-if=\"isMultiple\" type=\"primary\" @click=\"multipleOrderDetermine\">确认送达</el-button>\r\n            </div>\r\n        </div>\r\n        <div>\r\n            <el-table height=\"800px\"\r\n                      :data=\"orders\"\r\n                      style=\"width: 100%\"\r\n                      @selection-change=\"handleSelectionChange\">\r\n                <el-table-column\r\n                        type=\"selection\"\r\n                        width=\"55\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        label=\"商品\"\r\n                        width=\"180\">\r\n                    <template slot-scope=\"scope\">\r\n                        <div style=\"height: 120px;width: 120px\">\r\n                            <img :src=\"scope.row.img\" style=\"height: 100%;width: 100%\">\r\n                        </div>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"id\"\r\n                        label=\"订单编号\"\r\n                        width=\"180\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"goodsName\"\r\n                        label=\"商品名称\"\r\n                        width=\"180\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"time\"\r\n                        label=\"接单时间\"\r\n                        width=\"180\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"deliverArea\"\r\n                        label=\"发货地址\"\r\n                        width=\"180\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"receiveArea\"\r\n                        label=\"收货地址\"\r\n                        width=\"180\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"number\"\r\n                        label=\"数量\"\r\n                        width=\"80\">\r\n                </el-table-column>\r\n                <el-table-column width=\"240\">\r\n                    <template slot-scope=\"scope\">\r\n                        <div>\r\n                            <el-button type=\"primary\">详情</el-button>\r\n                            <el-button type=\"primary\" @click=\"orderDetermine(scope.row.id)\">确认送达</el-button>\r\n                        </div>\r\n                    </template>\r\n                </el-table-column>\r\n\r\n            </el-table>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n\r\n    import PersonOrder from \"@/api/dispatcher/PersonOrder\"\r\n\r\n    export default {\r\n        name: \"PersonOrder\",\r\n        data() {\r\n            return {\r\n                orders: [],             // 订单信息\r\n                page: 1,\r\n                limit: 5,\r\n                total: 0,\r\n                multipleSelection: [],\r\n                isMultiple: false\r\n            }\r\n        },\r\n        created() {\r\n            this.pageFindDispatcherOrder()\r\n        }, methods: {\r\n            pageFindDispatcherOrder() {   // 分页查找用户新创建的订单\r\n                PersonOrder.pageDisDispatcherOrder(this.page, this.limit).then(resp => {\r\n                    if (resp.data.code === 200) {\r\n                        this.orders = resp.data.data.data\r\n                        this.total = resp.data.data.total\r\n                    }\r\n                })\r\n            },\r\n            handleSizeChange(limit) {  // 每页数量改变\r\n                this.limit = limit\r\n                this.pageFindDispatcherOrder()\r\n            },\r\n            handleCurrentChange(page) {  // 页数改变\r\n                this.page = page\r\n                this.pageFindDispatcherOrder()\r\n            },\r\n            handleSelectionChange(val) {   // 多选操作\r\n                this.multipleSelection = []\r\n                val.forEach(item => {\r\n                    this.multipleSelection.push(item.id)\r\n                })\r\n                this.isMultiple = this.multipleSelection.length > 0\r\n            },\r\n            orderDetermine(id) {  // 单个接单\r\n                OrderPlat.orderReceive(id).then(resp => {\r\n                    if (resp.data.code === 200) {\r\n                        this.$message.success('接单成功!')\r\n                        this.pageFindDispatcherOrder()\r\n                        return\r\n                    }\r\n\r\n                    this.$message.warning('接单失败，当前订单已经被其他派送员选取了')\r\n                    this.pageFindDispatcherOrder()\r\n                })\r\n            },\r\n            multipleOrderDetermine() {  // 一次确认多个订单送达\r\n                this.$confirm('此操作将一次接收' + this.multipleSelection.length + '个订单,是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    // 处理下单操作\r\n                    OrderPlat.listOrderReceive(this.multipleSelection).then(resp => {\r\n                        if (resp.data.code === 200) {\r\n                            this.$message.success(resp.data.msg)\r\n                            this.pageFindDispatcherOrder()\r\n                            return\r\n                        }\r\n\r\n                        this.$message.error(resp.data.msg)  // 没有下单成功\r\n                    })\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消接单'\r\n                    })\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}