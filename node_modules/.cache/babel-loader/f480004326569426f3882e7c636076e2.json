{"ast":null,"code":"import CarApi from \"@/api/car/CarApi\";\nimport DispatcherApi from \"@/api/admin/DispatcherApi\";\nexport default {\n  name: \"Car\",\n\n  data() {\n    return {\n      carPageParams: {\n        name: '',\n        startTime: '',\n        endTime: '',\n        isDispatch: false\n      },\n      page: 1,\n      limit: 5,\n      total: 0,\n      cars: [],\n      carRequireNumber: 0,\n      // 司机申请了车辆的数量\n      isMultiple: false,\n      carIdList: [],\n      carSaveVisible: false,\n      carRequireVisible: false,\n      car: {\n        carId: '',\n        name: ''\n      },\n      isDispatch: false,\n      carDetailsVisible: false,\n      carDetails: {\n        id: '',\n        carId: '',\n        dispatcherId: '',\n        dispatcherName: '',\n        name: '',\n        startUseTime: '',\n        useTime: '',\n        state: 0\n      },\n      dispatcherVisible: false,\n      dispatchers: [],\n      dispatcher: {\n        id: '',\n        name: ''\n      },\n      carRequires: []\n    };\n  },\n\n  created() {\n    this.pageFind();\n    this.getCarRequireNumber();\n  },\n\n  methods: {\n    accessRequire() {// 同意司机的申请\n    },\n\n    refuseRequire() {\n      // 拒绝司机的申请\n      this.$confirm('确定该司机的车辆申请要求？', '拒绝申请', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {}).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消操作'\n        });\n      });\n    },\n\n    getCarRequires() {\n      // 获取请求车辆的司机以及其申请信息\n      this.carRequireVisible = true;\n      CarApi.getCarRequires().then(resp => {\n        if (resp.data.code === 200) {\n          this.carRequires = resp.data.data;\n        }\n      });\n    },\n\n    getCarRequireNumber() {\n      // 获取司机申请车辆的数量\n      CarApi.getCarRequireNumber().then(resp => {\n        if (resp.data.code === 200) {\n          this.carRequireNumber = resp.data.data;\n        }\n      });\n    },\n\n    addDispatcherToDetails() {\n      // 建立司机和车辆的联系\n      CarApi.relateCarAndDispatcher(this.carDetails.id, this.dispatcher.id).then(resp => {\n        this.dispatcherVisible = false;\n        this.carDetailsVisible = false;\n        this.pageFind();\n      });\n    },\n\n    showDispatcherVisible() {\n      // 展示司机信息\n      DispatcherApi.listDispatcher().then(resp => {\n        this.dispatchers = resp.data.data;\n      });\n      this.dispatcherVisible = true;\n    },\n\n    dissolveRelationship(id) {\n      // 解除车辆和司机的联系\n      CarApi.dissolveRelationship(id).then(resp => {\n        if (resp.data.code === 200) {\n          this.$message.success(resp.data.msg);\n          this.carDetailsVisible = false;\n          this.pageFind();\n          return;\n        }\n\n        this.$message.error(resp.data.msg);\n      });\n    },\n\n    showCarDetails(id) {\n      // 展示车辆信息\n      CarApi.getCarById(id).then(resp => {\n        if (resp.data.code === 200) {\n          this.carDetails = resp.data.data;\n          this.carDetailsVisible = true;\n          return;\n        }\n\n        this.$message.error(resp.data.msg);\n      });\n    },\n\n    carRemove(car) {\n      // 移除车辆信息通过 id 方式\n      let info = '此操作将永久删除' + car.name + '，并且连同删除其相关的信息, 是否继续?';\n\n      if (car.dispatcherId) {\n        info = '该车辆已经绑定了派送,删除后需要重新为派送员分配车辆, 是否继续?';\n      }\n\n      this.$confirm(info, '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        CarApi.removeCarById(car.id).then(resp => {\n          if (resp.data.code === 200) {\n            this.$message.success(resp.data.msg);\n            this.pageFind();\n            return;\n          }\n\n          this.$message.error(resp.data.msg);\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n\n    saveCar() {\n      // 添加车辆操作\n      if (!this.car.carId) {\n        this.$message.error('请输入车牌号');\n        return;\n      }\n\n      if (!this.car.name) {\n        this.$message.error('请输入车辆名称');\n        return;\n      } // 调用接口\n\n\n      CarApi.saveCar(this.car).then(resp => {\n        if (resp.data.code === 200) {\n          this.$message.success(resp.data.msg);\n          this.carSaveVisible = false;\n          this.pageFind();\n          return;\n        }\n\n        this.$message.error(resp.data.msg);\n      });\n    },\n\n    showSaveCar() {\n      // 展示添加车辆窗口\n      this.carSaveVisible = true;\n    },\n\n    pageFind() {\n      // 分页查看车辆信息\n      this.isDispatch = this.carPageParams.isDispatch;\n      CarApi.pageFind(this.page, this.limit, this.carPageParams).then(resp => {\n        if (resp.data.code === 200) {\n          this.cars = resp.data.data.data;\n          this.total = resp.data.data.total;\n          return;\n        }\n\n        this.$message.error(resp.data.data.msg);\n      });\n    },\n\n    handleSizeChange(limit) {\n      this.limit = limit;\n      this.pageFind();\n    },\n\n    handleCurrentChange(page) {\n      this.page = page;\n      this.pageFind();\n    },\n\n    multipleCarRemove() {\n      // 多选删除操作\n      this.$confirm('该操作一次将移除' + this.carIdList.length + '车辆记录', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        CarApi.listDeleteCars(this.carIdList).then(resp => {\n          if (resp.data.code === 200) {\n            this.$message.success('移除成功');\n            this.pageFind();\n            return;\n          }\n\n          this.$message.error('失败');\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n\n    handleSelectionChange(list) {\n      // 多选操作\n      this.carIdList = [];\n      list.forEach(item => {\n        this.carIdList.push(item.id);\n      });\n      this.isMultiple = this.carIdList.length > 0;\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAiSA;AACA;AAEA;EACAA,WADA;;EAEAC;IACA;MACAC;QACAF,QADA;QAEAG,aAFA;QAGAC,WAHA;QAIAC;MAJA,CADA;MAOAC,OAPA;MAQAC,QARA;MASAC,QATA;MAUAC,QAVA;MAWAC,mBAXA;MAWA;MACAC,iBAZA;MAaAC,aAbA;MAcAC,qBAdA;MAeAC,wBAfA;MAgBAC;QACAC,SADA;QAEAhB;MAFA,CAhBA;MAoBAK,iBApBA;MAqBAY,wBArBA;MAsBAC;QACAC,MADA;QAEAH,SAFA;QAGAI,gBAHA;QAIAC,kBAJA;QAKArB,QALA;QAMAsB,gBANA;QAOAC,WAPA;QAQAC;MARA,CAtBA;MAgCAC,wBAhCA;MAiCAC,eAjCA;MAkCAC;QACAR,MADA;QAEAnB;MAFA,CAlCA;MAsCA4B;IAtCA;EAwCA,CA3CA;;EA2CAC;IACA;IACA;EACA,CA9CA;;EA8CAC;IACAC;IAEA,CAHA;;IAIAC;MAAA;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA,OAEA,CANA,EAMAC,KANA,CAMA;QACA;UACAF,YADA;UAEAG;QAFA;MAIA,CAXA;IAYA,CAjBA;;IAkBAC;MAAA;MACA;MACAC;QACA;UACA;QACA;MACA,CAJA;IAKA,CAzBA;;IA0BAC;MAAA;MACAD;QACA;UACA;QACA;MACA,CAJA;IAKA,CAhCA;;IAiCAE;MAAA;MACAF;QACA;QACA;QACA;MACA,CAJA;IAKA,CAvCA;;IAwCAG;MAAA;MACAC;QACA;MACA,CAFA;MAGA;IACA,CA7CA;;IA8CAC;MAAA;MACAL;QACA;UACA;UACA;UACA;UACA;QACA;;QAEA;MACA,CATA;IAUA,CAzDA;;IA0DAM;MAAA;MACAN;QACA;UACA;UACA;UACA;QACA;;QAEA;MACA,CARA;IASA,CApEA;;IAqEAO;MAAA;MACA;;MACA;QACAC;MACA;;MACA;QACAf,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA;QACAI;UACA;YACA;YACA;YACA;UACA;;UAEA;QACA,CARA;MASA,CAdA,EAcAH,KAdA,CAcA;QACA;UACAF,YADA;UAEAG;QAFA;MAIA,CAnBA;IAoBA,CA9FA;;IA+FAW;MAAA;MACA;QACA;QACA;MACA;;MACA;QACA;QACA;MACA,CARA,CAUA;;;MACAT;QACA;UACA;UACA;UACA;UACA;QACA;;QAEA;MACA,CATA;IAWA,CArHA;;IAsHAU;MAAA;MACA;IACA,CAxHA;;IAyHAC;MAAA;MACA;MACAX;QACA;UACA;UACA;UACA;QACA;;QAEA;MACA,CARA;IASA,CApIA;;IAqIAY;MACA;MACA;IACA,CAxIA;;IAyIAC;MACA;MACA;IACA,CA5IA;;IA6IAC;MAAA;MACA;QACArB,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA;QACAI;UACA;YACA;YACA;YACA;UACA;;UAEA;QACA,CARA;MASA,CAdA,EAcAH,KAdA,CAcA;QACA;UACAF,YADA;UAEAG;QAFA;MAIA,CAnBA;IAoBA,CAlKA;;IAmKAiB;MAAA;MACA;MACAC;QACA;MACA,CAFA;MAIA;IACA;;EA1KA;AA9CA","names":["name","data","carPageParams","startTime","endTime","isDispatch","page","limit","total","cars","carRequireNumber","isMultiple","carIdList","carSaveVisible","carRequireVisible","car","carId","carDetailsVisible","carDetails","id","dispatcherId","dispatcherName","startUseTime","useTime","state","dispatcherVisible","dispatchers","dispatcher","carRequires","created","methods","accessRequire","refuseRequire","confirmButtonText","cancelButtonText","type","then","catch","message","getCarRequires","CarApi","getCarRequireNumber","addDispatcherToDetails","showDispatcherVisible","DispatcherApi","dissolveRelationship","showCarDetails","carRemove","info","saveCar","showSaveCar","pageFind","handleSizeChange","handleCurrentChange","multipleCarRemove","handleSelectionChange","list"],"sourceRoot":"src/views/car","sources":["Car.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <div style=\"height: 60px\">\r\n\r\n            <div style=\"float: left\">\r\n                <el-button type=\"primary\" plain @click=\"showSaveCar\">车辆入库</el-button>\r\n            </div>\r\n            <div style=\"float: left; padding-left: 20px\">\r\n                <el-date-picker\r\n                        v-model=\"carPageParams.startTime\"\r\n                        type=\"datetime\"\r\n                        placeholder=\"起始日期\">\r\n                </el-date-picker>\r\n            </div>\r\n            <div style=\"float: left;\">\r\n                <el-date-picker\r\n                        v-model=\"carPageParams.endTime\"\r\n                        type=\"datetime\"\r\n                        placeholder=\"截至日期\">\r\n                </el-date-picker>\r\n            </div>\r\n            <div style=\"float:left;padding-left: 10px\">\r\n                <el-switch\r\n                        v-model=\"carPageParams.isDispatch\"\r\n                        active-text=\"分配\"\r\n                        inactive-text=\"未分配\">\r\n                </el-switch>\r\n            </div>\r\n            <div style=\"float: left; padding-left: 20px\">\r\n                <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"pageFind\"></el-button>\r\n                <el-badge :value=\"carRequireNumber\" class=\"item\" style=\"padding-left: 10px\">\r\n                    <el-button @click=\"getCarRequires\">申请</el-button>\r\n                </el-badge>\r\n            </div>\r\n        </div>\r\n        <div>\r\n            <el-table height=\"700px\"\r\n                      :data=\"cars\"\r\n                      style=\"width: 100%\"\r\n                      @selection-change=\"handleSelectionChange\">\r\n                <el-table-column\r\n                        type=\"selection\"\r\n                        width=\"55\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"id\"\r\n                        label=\"车辆编号\"\r\n                        width=\"180\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"carId\"\r\n                        label=\"车牌号\"\r\n                        width=\"180\">\r\n                </el-table-column>\r\n                <el-table-column v-if=\"isDispatch\"\r\n                                 prop=\"dispatcherName\"\r\n                                 label=\"司机名称\"\r\n                                 width=\"180\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"name\"\r\n                        label=\"车辆名称\"\r\n                        width=\"150\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"startUseTime\"\r\n                        label=\"开始使用时间\"\r\n                        width=\"180\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"useTime\"\r\n                        label=\"使用天数\"\r\n                        width=\"80\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"state\"\r\n                        label=\"车辆状态\"\r\n                        width=\"80\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-tag v-if=\"scope.row.state === 1\" type=\"success\">使用中</el-tag>\r\n                        <el-tag v-if=\"scope.row.state === 0\" type=\"danger\">维修中</el-tag>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column width=\"240\">\r\n                    <template slot-scope=\"scope\">\r\n                        <div>\r\n                            <el-button type=\"primary\" @click=\"showCarDetails(scope.row.id)\">详情</el-button>\r\n                            <el-button type=\"danger\" @click=\"carRemove(scope.row)\">删除</el-button>\r\n                        </div>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n        </div>\r\n        <div style=\"float: left; padding-left: 20px\">\r\n            <el-pagination\r\n                    @size-change=\"handleSizeChange\"\r\n                    @current-change=\"handleCurrentChange\"\r\n                    :page-sizes=\"[5, 10, 20, 40]\"\r\n                    :page-size=\"limit\"\r\n                    layout=\"total, sizes, prev, pager, next, jumper\"\r\n                    :total=\"total\">\r\n            </el-pagination>\r\n        </div>\r\n        <div style=\"float: left; padding-left: 20px\">\r\n            <el-button v-if=\"isMultiple\" type=\"danger\" @click=\"multipleCarRemove\">多选删除</el-button>\r\n        </div>\r\n\r\n\r\n        <div>\r\n            <el-dialog\r\n                    title=\"车辆入库\"\r\n                    :visible.sync=\"carSaveVisible\"\r\n                    width=\"30%\">\r\n                <span>\r\n                    <el-form :model=\"car\" status-icon ref=\"car\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n                        <el-form-item label=\"车辆牌照\">\r\n                            <el-input type=\"text\" v-model=\"car.carId\" autocomplete=\"off\"></el-input>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"车辆名称\">\r\n                            <el-input type=\"text\" v-model=\"car.name\" autocomplete=\"off\"></el-input>\r\n                        </el-form-item>\r\n                    </el-form>\r\n                </span>\r\n                <span slot=\"footer\" class=\"dialog-footer\">\r\n                    <el-button @click=\"carSaveVisible = false\">取 消</el-button>\r\n                    <el-button type=\"primary\" @click=\"saveCar\">确 定</el-button>\r\n                </span>\r\n            </el-dialog>\r\n\r\n        </div>\r\n        <div>\r\n            <el-dialog\r\n                    title=\"车辆详情\"\r\n                    :visible.sync=\"carDetailsVisible\"\r\n                    width=\"50%\">\r\n                <span>\r\n                    <el-descriptions class=\"margin-top\" :column=\"3\" border>\r\n                        <template slot=\"extra\" v-if=\"carDetails.state === 1\">\r\n                            <el-button v-if=\"!carDetails.dispatcherId\" type=\"success\" size=\"small\"\r\n                                       plain @click=\"showDispatcherVisible\">添加司机</el-button>\r\n                            <el-button v-if=\"carDetails.dispatcherId\" type=\"danger\" size=\"small\" plain\r\n                                       @click=\"dissolveRelationship(carDetails.id)\">解除司机联系</el-button>\r\n                        </template>\r\n                        <el-descriptions-item>\r\n                            <template slot=\"label\">\r\n                                <i class=\"el-icon-user\"></i>\r\n                                车辆编号\r\n                            </template>\r\n                            {{carDetails.id}}\r\n                        </el-descriptions-item>\r\n                        <el-descriptions-item>\r\n                            <template slot=\"label\">\r\n                                <i class=\"el-icon-user\"></i>\r\n                                车牌号\r\n                            </template>\r\n                            {{carDetails.carId}}\r\n                        </el-descriptions-item>\r\n                        <el-descriptions-item>\r\n                            <template slot=\"label\">\r\n                                <i class=\"el-icon-user\"></i>\r\n                                车辆名称\r\n                            </template>\r\n                            {{carDetails.name}}\r\n                        </el-descriptions-item>\r\n                        <el-descriptions-item v-if=\"carDetails.dispatcherId\">\r\n                            <template slot=\"label\">\r\n                                <i class=\"el-icon-user\"></i>\r\n                                使用者\r\n                            </template>\r\n                            {{carDetails.dispatcherName}}\r\n                        </el-descriptions-item>\r\n                        <el-descriptions-item>\r\n                            <template slot=\"label\">\r\n                                <i class=\"el-icon-user\"></i>\r\n                                开始使用时间\r\n                            </template>\r\n                            {{carDetails.startUseTime}}\r\n                        </el-descriptions-item><el-descriptions-item>\r\n                            <template slot=\"label\">\r\n                                <i class=\"el-icon-user\"></i>\r\n                                使用时长\r\n                            </template>\r\n                            {{carDetails.useTime}}\r\n                        </el-descriptions-item>\r\n                        <el-descriptions-item>\r\n                            <template slot=\"label\">\r\n                                <i class=\"el-icon-user\"></i>\r\n                                车辆状态\r\n                            </template>\r\n                            <el-tag type=\"success\" v-if=\"carDetails.state === 1\">使用中</el-tag>\r\n                            <el-tag type=\"danger\" v-if=\"carDetails.state === 0\">维修中</el-tag>\r\n                        </el-descriptions-item>\r\n\r\n                    </el-descriptions>\r\n                </span>\r\n                <span slot=\"footer\" class=\"dialog-footer\">\r\n                    <el-button type=\"primary\" @click=\"\">修 改</el-button>\r\n                    <el-button @click=\"carDetailsVisible = false\">关 闭</el-button>\r\n                </span>\r\n            </el-dialog>\r\n        </div>\r\n\r\n        <div>\r\n            <el-dialog\r\n                    title=\"提示\"\r\n                    :visible.sync=\"dispatcherVisible\"\r\n                    width=\"30%\">\r\n                <span>\r\n                    <template>\r\n                        <el-select v-model=\"dispatcher.id\" placeholder=\"请选择\">\r\n                            <el-option\r\n                                    v-for=\"item in dispatchers\"\r\n                                    :key=\"item.id\"\r\n                                    :label=\"item.name\"\r\n                                    :value=\"item.id\">\r\n                            </el-option>\r\n                        </el-select>\r\n                    </template>\r\n                </span>\r\n                <span slot=\"footer\" class=\"dialog-footer\">\r\n                    <el-button @click=\"dispatcherVisible = false\">取 消</el-button>\r\n                    <el-button type=\"primary\" @click=\"addDispatcherToDetails\">确 定</el-button>\r\n                </span>\r\n            </el-dialog>\r\n        </div>\r\n        <div>\r\n            <el-dialog\r\n                    title=\"提示\"\r\n                    :visible.sync=\"carRequireVisible\"\r\n                    width=\"80%\">\r\n                <span>\r\n                     <template>\r\n                         <el-table height=\"400\"\r\n                                   :data=\"carRequires\"\r\n                                   style=\"width: 100%\">\r\n                             <el-table-column\r\n                                     prop=\"carId\"\r\n                                     label=\"车辆编号\"\r\n                                     width=\"180\">\r\n                             </el-table-column>\r\n                             <el-table-column\r\n                                     prop=\"carCarId\"\r\n                                     label=\"车辆牌照\"\r\n                                     width=\"180\">\r\n                             </el-table-column>\r\n                             <el-table-column\r\n                                     prop=\"carName\"\r\n                                     label=\"车辆名称\"\r\n                                     width=\"180\">\r\n                             </el-table-column>\r\n                             <el-table-column\r\n                                     prop=\"startUseTime\"\r\n                                     label=\"开始使用时间\"\r\n                                     width=\"180\">\r\n                             </el-table-column>\r\n                             <el-table-column\r\n                                     prop=\"useTime\"\r\n                                     label=\"使用天数\"\r\n                                     width=\"140\">\r\n                             </el-table-column>\r\n                             <el-table-column\r\n                                     prop=\"dispatcherId\"\r\n                                     label=\"申请人编号\"\r\n                                     width=\"180\">\r\n                             </el-table-column>\r\n                             <el-table-column\r\n                                     prop=\"dispatcherName\"\r\n                                     label=\"申请人名称\"\r\n                                     width=\"180\">\r\n                             </el-table-column>\r\n                             <el-table-column width=\"180\">\r\n                                 <template slot-scope=\"scope\">\r\n                                     <el-button type=\"success\" @click=\"accessRequire(scope.row.id)\">通过</el-button>\r\n                                     <el-button type=\"info\" @click=\"refuseRequire(scope.row.id)\">拒绝</el-button>\r\n                                 </template>\r\n                             </el-table-column>\r\n                         </el-table>\r\n                     </template>\r\n                </span>\r\n                <span slot=\"footer\" class=\"dialog-footer\">\r\n                    <el-button @click=\"carRequireVisible = false\">关 闭</el-button>\r\n                </span>\r\n            </el-dialog>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n\r\n    import CarApi from \"@/api/car/CarApi\"\r\n    import DispatcherApi from \"@/api/admin/DispatcherApi\"\r\n\r\n    export default {\r\n        name: \"Car\",\r\n        data() {\r\n            return {\r\n                carPageParams: {\r\n                    name: '',\r\n                    startTime: '',\r\n                    endTime: '',\r\n                    isDispatch: false\r\n                },\r\n                page: 1,\r\n                limit: 5,\r\n                total: 0,\r\n                cars: [],\r\n                carRequireNumber: 0,    // 司机申请了车辆的数量\r\n                isMultiple: false,\r\n                carIdList: [],\r\n                carSaveVisible: false,\r\n                carRequireVisible: false,\r\n                car: {\r\n                    carId: '',\r\n                    name: ''\r\n                },\r\n                isDispatch: false,\r\n                carDetailsVisible: false,\r\n                carDetails: {\r\n                    id: '',\r\n                    carId: '',\r\n                    dispatcherId: '',\r\n                    dispatcherName: '',\r\n                    name: '',\r\n                    startUseTime: '',\r\n                    useTime: '',\r\n                    state: 0\r\n                },\r\n                dispatcherVisible: false,\r\n                dispatchers: [],\r\n                dispatcher: {\r\n                    id: '',\r\n                    name: ''\r\n                },\r\n                carRequires: []\r\n            }\r\n        }, created() {\r\n            this.pageFind()\r\n            this.getCarRequireNumber()\r\n        }, methods: {\r\n            accessRequire() {  // 同意司机的申请\r\n\r\n            },\r\n            refuseRequire() {  // 拒绝司机的申请\r\n                this.$confirm('确定该司机的车辆申请要求？', '拒绝申请', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消操作'\r\n                    })\r\n                })\r\n            },\r\n            getCarRequires() {  // 获取请求车辆的司机以及其申请信息\r\n                this.carRequireVisible = true\r\n                CarApi.getCarRequires().then(resp => {\r\n                    if (resp.data.code === 200) {\r\n                        this.carRequires = resp.data.data\r\n                    }\r\n                })\r\n            },\r\n            getCarRequireNumber() {   // 获取司机申请车辆的数量\r\n                CarApi.getCarRequireNumber().then(resp => {\r\n                    if (resp.data.code === 200) {\r\n                        this.carRequireNumber = resp.data.data\r\n                    }\r\n                })\r\n            },\r\n            addDispatcherToDetails() {  // 建立司机和车辆的联系\r\n                CarApi.relateCarAndDispatcher(this.carDetails.id, this.dispatcher.id).then(resp => {\r\n                    this.dispatcherVisible = false\r\n                    this.carDetailsVisible = false\r\n                    this.pageFind()\r\n                })\r\n            },\r\n            showDispatcherVisible() {  // 展示司机信息\r\n                DispatcherApi.listDispatcher().then(resp => {\r\n                    this.dispatchers = resp.data.data\r\n                })\r\n                this.dispatcherVisible = true\r\n            },\r\n            dissolveRelationship(id) {   // 解除车辆和司机的联系\r\n                CarApi.dissolveRelationship(id).then(resp => {\r\n                    if (resp.data.code === 200) {\r\n                        this.$message.success(resp.data.msg)\r\n                        this.carDetailsVisible = false\r\n                        this.pageFind()\r\n                        return\r\n                    }\r\n\r\n                    this.$message.error(resp.data.msg)\r\n                })\r\n            },\r\n            showCarDetails(id) {    // 展示车辆信息\r\n                CarApi.getCarById(id).then(resp => {\r\n                    if (resp.data.code === 200) {\r\n                        this.carDetails = resp.data.data\r\n                        this.carDetailsVisible = true\r\n                        return\r\n                    }\r\n\r\n                    this.$message.error(resp.data.msg)\r\n                })\r\n            },\r\n            carRemove(car) {    // 移除车辆信息通过 id 方式\r\n                let info = '此操作将永久删除' + car.name + '，并且连同删除其相关的信息, 是否继续?'\r\n                if (car.dispatcherId) {\r\n                    info = '该车辆已经绑定了派送,删除后需要重新为派送员分配车辆, 是否继续?'\r\n                }\r\n                this.$confirm(info, '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    CarApi.removeCarById(car.id).then(resp => {\r\n                        if (resp.data.code === 200) {\r\n                            this.$message.success(resp.data.msg)\r\n                            this.pageFind()\r\n                            return\r\n                        }\r\n\r\n                        this.$message.error(resp.data.msg)\r\n                    })\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消删除'\r\n                    })\r\n                })\r\n            },\r\n            saveCar() {    // 添加车辆操作\r\n                if (!this.car.carId) {\r\n                    this.$message.error('请输入车牌号')\r\n                    return\r\n                }\r\n                if (!this.car.name) {\r\n                    this.$message.error('请输入车辆名称')\r\n                    return\r\n                }\r\n\r\n                // 调用接口\r\n                CarApi.saveCar(this.car).then(resp => {\r\n                    if (resp.data.code === 200) {\r\n                        this.$message.success(resp.data.msg)\r\n                        this.carSaveVisible = false\r\n                        this.pageFind()\r\n                        return\r\n                    }\r\n\r\n                    this.$message.error(resp.data.msg)\r\n                })\r\n\r\n            },\r\n            showSaveCar() {    // 展示添加车辆窗口\r\n                this.carSaveVisible = true\r\n            },\r\n            pageFind() {  // 分页查看车辆信息\r\n                this.isDispatch = this.carPageParams.isDispatch\r\n                CarApi.pageFind(this.page, this.limit, this.carPageParams).then(resp => {\r\n                    if (resp.data.code === 200) {\r\n                        this.cars = resp.data.data.data\r\n                        this.total = resp.data.data.total\r\n                        return\r\n                    }\r\n\r\n                    this.$message.error(resp.data.data.msg)\r\n                })\r\n            },\r\n            handleSizeChange(limit) {\r\n                this.limit = limit\r\n                this.pageFind()\r\n            },\r\n            handleCurrentChange(page) {\r\n                this.page = page\r\n                this.pageFind()\r\n            },\r\n            multipleCarRemove() {  // 多选删除操作\r\n                this.$confirm('该操作一次将移除' + this.carIdList.length + '车辆记录', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    CarApi.listDeleteCars(this.carIdList).then(resp => {\r\n                        if (resp.data.code === 200) {\r\n                            this.$message.success('移除成功')\r\n                            this.pageFind()\r\n                            return\r\n                        }\r\n\r\n                        this.$message.error('失败')\r\n                    })\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消删除'\r\n                    })\r\n                })\r\n            },\r\n            handleSelectionChange(list) {  // 多选操作\r\n                this.carIdList = []\r\n                list.forEach(item => {\r\n                    this.carIdList.push(item.id)\r\n                })\r\n\r\n                this.isMultiple = this.carIdList.length > 0\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}