{"ast":null,"code":"import CarManage from \"@/api/dispatcher/CarManage\";\nexport default {\n  name: \"CarManage\",\n\n  data() {\n    return {\n      haveCar: false,\n      carRequireVisible: false,\n      carRepairVisible: false,\n      car: {\n        // 司机拥有车辆时车辆的信息\n        id: '',\n        carId: '',\n        name: '',\n        startUseTime: '',\n        useTime: ''\n      },\n      carPageParams: {\n        // 条件查询车辆信息\n        name: '',\n        startTime: '',\n        endTime: '',\n        isDispatch: false\n      },\n      cars: [],\n      page: 1,\n      limit: 5,\n      total: 0,\n      carRequire: {\n        id: null,\n        carId: '',\n        carCarId: '',\n        carName: '',\n        startUseTime: '',\n        useTime: 0\n      }\n    };\n  },\n\n  created() {\n    this.getCar();\n    this.getCarRequire();\n  },\n\n  methods: {\n    carRepair() {\n      // 进行车辆维修操作\n      this.$confirm('你确定要维修车辆' + this.car.carId + ',维修后需要重新选择车辆,是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        CarManage.repair(this.car.id).then(resp => {\n          if (resp.data.code === 200) {\n            this.$message.success(resp.data.msg);\n            this.haveCar = false;\n            this.getCar();\n            return;\n          }\n\n          this.$message.error(resp.data.msg);\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消操作'\n        });\n      });\n    },\n\n    carRequireVisibleShow() {\n      this.carRequireVisible = true;\n    },\n\n    getCarRequire() {\n      // 获取申请车辆的请求\n      CarManage.getCarRequire().then(resp => {\n        if (resp.data.code === 200) {\n          if (resp.data.data) {\n            this.carRequire = resp.data.data;\n          }\n\n          return;\n        }\n\n        this.$message.success(resp.data.msg);\n      });\n    },\n\n    requireUse(car) {\n      // 申请使用车辆\n      this.$confirm('你确定要申请' + car.name + '这辆车,如果已经申请了则替换，是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        CarManage.requireCar(car.id).then(resp => {\n          if (resp.data.code === 200) {\n            if (resp.data.data) {\n              this.$message.success('操作成功');\n              this.getCarRequire(); // 更新申请情况\n\n              return;\n            }\n          }\n\n          this.$message.error('操作失败');\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消申请'\n        });\n      });\n    },\n\n    getCar() {\n      // 司机获取车辆的信息\n      CarManage.getCar().then(resp => {\n        if (resp.data.code === 200) {\n          if (resp.data.data) {\n            this.haveCar = true;\n            this.car = resp.data.data;\n            return;\n          }\n\n          this.pageFind(); // 没有车辆信息则分页查找车辆信息 让司机选车\n\n          return;\n        }\n\n        this.$message.error(resp.data.msg);\n      });\n    },\n\n    dissolveRelationship() {\n      // 司机解除其和车辆的关系\n      this.$confirm('你确定要解除和' + this.car.name + '这辆车的使用关系，是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        CarManage.dissolveRelationship(this.car.id).then(resp => {\n          if (resp.data.code === 200) {\n            this.haveCar = false;\n            this.getCar();\n            return;\n          }\n\n          this.$message.error(resp.data.msg);\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消操作'\n        });\n      });\n    },\n\n    handleSizeChange(limit) {\n      this.limit = limit;\n      this.pageFind();\n    },\n\n    handleCurrentChange(page) {\n      this.page = page;\n      this.pageFind();\n    },\n\n    pageFind() {\n      // 司机没有分配车辆的情况下 分页查找未分配车辆的信息\n      CarManage.pageFind(this.page, this.limit, this.carPageParams).then(resp => {\n        if (resp.data.code === 200) {\n          this.cars = resp.data.data.data;\n          this.total = resp.data.data.total;\n          return;\n        }\n\n        this.$message.error(resp.data.msg);\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAoKA;AAEA;EACAA,iBADA;;EAEAC;IACA;MACAC,cADA;MAEAC,wBAFA;MAGAC,uBAHA;MAIAC;QAAA;QACAC,MADA;QAEAC,SAFA;QAGAP,QAHA;QAIAQ,gBAJA;QAKAC;MALA,CAJA;MAWAC;QAAA;QACAV,QADA;QAEAW,aAFA;QAGAC,WAHA;QAIAC;MAJA,CAXA;MAiBAC,QAjBA;MAkBAC,OAlBA;MAmBAC,QAnBA;MAoBAC,QApBA;MAqBAC;QACAZ,QADA;QAEAC,SAFA;QAGAY,YAHA;QAIAC,WAJA;QAKAZ,gBALA;QAMAC;MANA;IArBA;EA8BA,CAjCA;;EAiCAY;IACA;IACA;EACA,CApCA;;EAoCAC;IACAC;MAAA;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA;QACAC;UACA;YACA;YACA;YACA;YACA;UACA;;UAEA;QACA,CATA;MAUA,CAfA,EAeAC,KAfA,CAeA;QACA;UACAH,YADA;UAEAI;QAFA;MAIA,CApBA;IAqBA,CAvBA;;IAwBAC;MACA;IACA,CA1BA;;IA2BAC;MAAA;MACAJ;QACA;UACA;YACA;UACA;;UACA;QACA;;QAEA;MACA,CATA;IAUA,CAtCA;;IAuCAK;MAAA;MACA;QACAT,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA;QACAC;UACA;YACA;cACA;cACA,qBAFA,CAEA;;cACA;YACA;UACA;;UAEA;QACA,CAVA;MAWA,CAhBA,EAgBAC,KAhBA,CAgBA;QACA;UACAH,YADA;UAEAI;QAFA;MAIA,CArBA;IAsBA,CA9DA;;IA+DAI;MAAA;MACAN;QACA;UACA;YACA;YACA;YACA;UACA;;UAEA,gBAPA,CAOA;;UACA;QACA;;QAEA;MACA,CAbA;IAcA,CA9EA;;IA+EAO;MAAA;MACA;QACAX,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA;QACAC;UACA;YACA;YACA;YACA;UACA;;UAEA;QACA,CARA;MASA,CAdA,EAcAC,KAdA,CAcA;QACA;UACAH,YADA;UAEAI;QAFA;MAIA,CAnBA;IAoBA,CApGA;;IAqGAM;MACA;MACA;IACA,CAxGA;;IAyGAC;MACA;MACA;IACA,CA5GA;;IA6GAC;MAAA;MACAV;QACA;UACA;UACA;UAEA;QACA;;QAEA;MACA,CATA;IAUA;;EAxHA;AApCA","names":["name","data","haveCar","carRequireVisible","carRepairVisible","car","id","carId","startUseTime","useTime","carPageParams","startTime","endTime","isDispatch","cars","page","limit","total","carRequire","carCarId","carName","created","methods","carRepair","confirmButtonText","cancelButtonText","type","then","CarManage","catch","message","carRequireVisibleShow","getCarRequire","requireUse","getCar","dissolveRelationship","handleSizeChange","handleCurrentChange","pageFind"],"sourceRoot":"src/views/dispatcher","sources":["CarManage.vue"],"sourcesContent":["<template>\r\n    <div>\r\n\r\n        <!-- 已经分配了车辆 -->\r\n        <div v-if=\"haveCar\">\r\n            <div>\r\n                <el-descriptions class=\"margin-top\" :column=\"3\" :size=\"size\" border>\r\n                    <template slot=\"extra\">\r\n                        <el-button type=\"danger\" plain size=\"small\" @click=\"carRepairVisible\">维修</el-button>\r\n                        <el-button type=\"danger\" plain size=\"small\" @click=\"dissolveRelationship\">解除使用\r\n                        </el-button>\r\n                    </template>\r\n                    <el-descriptions-item>\r\n                        <template slot=\"label\">\r\n                            <i class=\"el-icon-user\"></i>\r\n                            车辆编号\r\n                        </template>\r\n                        {{car.id}}\r\n                    </el-descriptions-item>\r\n                    <el-descriptions-item>\r\n                        <template slot=\"label\">\r\n                            <i class=\"el-icon-user\"></i>\r\n                            车辆牌照\r\n                        </template>\r\n                        {{car.carId}}\r\n                    </el-descriptions-item>\r\n                    <el-descriptions-item>\r\n                        <template slot=\"label\">\r\n                            <i class=\"el-icon-user\"></i>\r\n                            车辆名称\r\n                        </template>\r\n                        {{car.name}}\r\n                    </el-descriptions-item>\r\n                    <el-descriptions-item>\r\n                        <template slot=\"label\">\r\n                            <i class=\"el-icon-user\"></i>\r\n                            开始使用时间\r\n                        </template>\r\n                        {{car.startUseTime}}\r\n                    </el-descriptions-item>\r\n                    <el-descriptions-item>\r\n                        <template slot=\"label\">\r\n                            <i class=\"el-icon-user\"></i>\r\n                            累计使用天数\r\n                        </template>\r\n                        {{car.useTime}}\r\n                    </el-descriptions-item>\r\n                </el-descriptions>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 没有分配车辆 -->\r\n        <div v-if=\"!haveCar\">\r\n            <div style=\"height: 60px\">\r\n                <div style=\"float:left;\">\r\n                    <el-pagination\r\n                            @size-change=\"handleSizeChange\"\r\n                            @current-change=\"handleCurrentChange\"\r\n                            :page-sizes=\"[5, 10, 20, 40]\"\r\n                            :page-size=\"limit\"\r\n                            layout=\"total, sizes, prev, pager, next, jumper\"\r\n                            :total=\"total\">\r\n                    </el-pagination>\r\n                </div>\r\n                <div style=\"float:left; padding-left: 30px\" v-if=\"carRequire.id\">\r\n                    <el-button type=\"primary\" @click=\"carRequireVisibleShow\">查看申请分配</el-button>\r\n                </div>\r\n            </div>\r\n\r\n            <div>\r\n                <template>\r\n                    <el-table height=\"800\"\r\n                              :data=\"cars\"\r\n                              style=\"width: 100%\">\r\n                        <el-table-column\r\n                                prop=\"id\"\r\n                                label=\"车辆编号\"\r\n                                width=\"180\">\r\n                        </el-table-column>\r\n                        <el-table-column\r\n                                prop=\"name\"\r\n                                label=\"车辆名称\"\r\n                                width=\"180\">\r\n                        </el-table-column>\r\n                        <el-table-column\r\n                                prop=\"carId\"\r\n                                label=\"车辆牌照\"\r\n                                width=\"180\">\r\n                        </el-table-column>\r\n                        <el-table-column\r\n                                prop=\"startUseTime\"\r\n                                label=\"开始使用日期\"\r\n                                width=\"180\">\r\n                        </el-table-column>\r\n                        <el-table-column\r\n                                prop=\"useTime\"\r\n                                label=\"累计使用天数\"\r\n                                width=\"180\">\r\n                        </el-table-column>\r\n                        <el-table-column width=\"180px\">\r\n                            <template slot-scope=\"scope\">\r\n                                <el-button type=\"success\" plain @click=\"requireUse(scope.row)\">申请使用</el-button>\r\n                            </template>\r\n                        </el-table-column>\r\n                    </el-table>\r\n                </template>\r\n            </div>\r\n\r\n            <div>\r\n                <el-dialog\r\n                        title=\"提示\"\r\n                        :visible.sync=\"carRequireVisible\"\r\n                        width=\"50%\">\r\n                    <span>\r\n                        <el-descriptions class=\"margin-top\" :column=\"3\" :size=\"size\" border>\r\n                            <el-descriptions-item>\r\n                                <template slot=\"label\">\r\n                                    <i class=\"el-icon-user\"></i>\r\n                                    车辆编号\r\n                                </template>\r\n                                {{carRequire.carId}}\r\n                            </el-descriptions-item>\r\n                            <el-descriptions-item>\r\n                                <template slot=\"label\">\r\n                                    <i class=\"el-icon-user\"></i>\r\n                                    车辆牌照\r\n                                </template>\r\n                                {{carRequire.carCarId}}\r\n                            </el-descriptions-item>\r\n                            <el-descriptions-item>\r\n                                <template slot=\"label\">\r\n                                    <i class=\"el-icon-user\"></i>\r\n                                    车辆名称\r\n                                </template>\r\n                                {{carRequire.carName}}\r\n                            </el-descriptions-item>\r\n                            <el-descriptions-item>\r\n                                <template slot=\"label\">\r\n                                    <i class=\"el-icon-user\"></i>\r\n                                    开始使用时间\r\n                                </template>\r\n                                {{carRequire.startUseTime}}\r\n                            </el-descriptions-item>\r\n                            <el-descriptions-item>\r\n                                <template slot=\"label\">\r\n                                    <i class=\"el-icon-user\"></i>\r\n                                    车辆使用天数\r\n                                </template>\r\n                                {{carRequire.useTime}}\r\n                            </el-descriptions-item>\r\n                        </el-descriptions>\r\n                    </span>\r\n                    <span slot=\"footer\" class=\"dialog-footer\">\r\n                        <el-button type=\"primary\" @click=\"carRequireVisible = false\">关 闭</el-button>\r\n                    </span>\r\n                </el-dialog>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n\r\n    import CarManage from \"@/api/dispatcher/CarManage\"\r\n\r\n    export default {\r\n        name: \"CarManage\",\r\n        data() {\r\n            return {\r\n                haveCar: false,\r\n                carRequireVisible: false,\r\n                carRepairVisible: false,\r\n                car: {    // 司机拥有车辆时车辆的信息\r\n                    id: '',\r\n                    carId: '',\r\n                    name: '',\r\n                    startUseTime: '',\r\n                    useTime: ''\r\n                },\r\n                carPageParams: {   // 条件查询车辆信息\r\n                    name: '',\r\n                    startTime: '',\r\n                    endTime: '',\r\n                    isDispatch: false\r\n                },\r\n                cars: [],\r\n                page: 1,\r\n                limit: 5,\r\n                total: 0,\r\n                carRequire: {\r\n                    id: null,\r\n                    carId: '',\r\n                    carCarId: '',\r\n                    carName: '',\r\n                    startUseTime: '',\r\n                    useTime: 0\r\n                }\r\n            }\r\n        }, created() {\r\n            this.getCar()\r\n            this.getCarRequire()\r\n        }, methods: {\r\n            carRepair() {      // 进行车辆维修操作\r\n                this.$confirm('你确定要维修车辆' + this.car.carId + ',维修后需要重新选择车辆,是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    CarManage.repair(this.car.id).then(resp => {\r\n                        if (resp.data.code === 200) {\r\n                            this.$message.success(resp.data.msg)\r\n                            this.haveCar = false\r\n                            this.getCar()\r\n                            return\r\n                        }\r\n\r\n                        this.$message.error(resp.data.msg)\r\n                    })\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消操作'\r\n                    })\r\n                })\r\n            },\r\n            carRequireVisibleShow() {\r\n                this.carRequireVisible = true\r\n            },\r\n            getCarRequire() {   // 获取申请车辆的请求\r\n                CarManage.getCarRequire().then(resp => {\r\n                    if (resp.data.code === 200) {\r\n                        if (resp.data.data) {\r\n                            this.carRequire = resp.data.data\r\n                        }\r\n                        return\r\n                    }\r\n\r\n                    this.$message.success(resp.data.msg)\r\n                })\r\n            },\r\n            requireUse(car) {  // 申请使用车辆\r\n                this.$confirm('你确定要申请' + car.name + '这辆车,如果已经申请了则替换，是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    CarManage.requireCar(car.id).then(resp => {\r\n                        if (resp.data.code === 200) {\r\n                            if (resp.data.data) {\r\n                                this.$message.success('操作成功')\r\n                                this.getCarRequire()    // 更新申请情况\r\n                                return\r\n                            }\r\n                        }\r\n\r\n                        this.$message.error('操作失败')\r\n                    })\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消申请'\r\n                    })\r\n                })\r\n            },\r\n            getCar() {   // 司机获取车辆的信息\r\n                CarManage.getCar().then(resp => {\r\n                    if (resp.data.code === 200) {\r\n                        if (resp.data.data) {\r\n                            this.haveCar = true\r\n                            this.car = resp.data.data\r\n                            return\r\n                        }\r\n\r\n                        this.pageFind()  // 没有车辆信息则分页查找车辆信息 让司机选车\r\n                        return\r\n                    }\r\n\r\n                    this.$message.error(resp.data.msg)\r\n                })\r\n            },\r\n            dissolveRelationship() {   // 司机解除其和车辆的关系\r\n                this.$confirm('你确定要解除和' + this.car.name + '这辆车的使用关系，是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    CarManage.dissolveRelationship(this.car.id).then(resp => {\r\n                        if (resp.data.code === 200) {\r\n                            this.haveCar = false\r\n                            this.getCar()\r\n                            return\r\n                        }\r\n\r\n                        this.$message.error(resp.data.msg)\r\n                    })\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消操作'\r\n                    })\r\n                })\r\n            },\r\n            handleSizeChange(limit) {\r\n                this.limit = limit\r\n                this.pageFind()\r\n            },\r\n            handleCurrentChange(page) {\r\n                this.page = page\r\n                this.pageFind()\r\n            },\r\n            pageFind() {   // 司机没有分配车辆的情况下 分页查找未分配车辆的信息\r\n                CarManage.pageFind(this.page, this.limit, this.carPageParams).then(resp => {\r\n                    if (resp.data.code === 200) {\r\n                        this.cars = resp.data.data.data\r\n                        this.total = resp.data.data.total\r\n\r\n                        return\r\n                    }\r\n\r\n                    this.$message.error(resp.data.msg)\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}