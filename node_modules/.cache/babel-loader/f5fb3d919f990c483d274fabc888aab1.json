{"ast":null,"code":"import inOrderApi from '@/api/warehouse/InOrderApi';\nimport adminApi from '@/api/admin/Admin';\nimport goodsApi from '@/api/warehouse/GoodsApi';\nexport default {\n  name: \"InOrder\",\n\n  data() {\n    return {\n      inOrderList: [],\n      page: 1,\n      limit: 5,\n      total: 0,\n      inOrderQueryVo: {\n        // 查询条件对象\n        goodsId: null,\n        adminId: null,\n        timeStart: '',\n        timeEnd: ''\n      },\n      excelQueryVo: {\n        // 导出文件时条件查询对象\n        goodsId: null,\n        adminId: null,\n        timeStart: '',\n        timeEnd: ''\n      },\n      excelPage: 1,\n      excelLimit: 5,\n      detailOrder: {\n        id: '',\n        goodsId: '',\n        number: 0,\n        inTime: '',\n        goodsName: '',\n        img: '',\n        adminUsername: '',\n        adminId: ''\n      },\n      detailOrderVisible: false,\n      adminList: [],\n      goodsList: []\n    };\n  },\n\n  created() {\n    this.pageFind();\n    this.listAdmin();\n    this.listGoods();\n  },\n\n  methods: {\n    pageFind() {\n      // 分页条件查找商品信息\n      let timeStart = this.inOrderQueryVo.timeStart;\n      let timeEnd = this.inOrderQueryVo.timeEnd; // 检查时间条件是否合格\n\n      if (timeStart && timeEnd) {\n        let start = new Date(timeStart);\n        let end = new Date(timeEnd);\n\n        if (start > end) {\n          this.$message.error('时间范围错误！');\n          return;\n        }\n      } // 得到结果 填充数据\n\n\n      inOrderApi.pageFind(this.page, this.limit, this.inOrderQueryVo).then(resp => {\n        this.inOrderList = resp.data.data.data;\n        this.total = resp.data.data.total; // 更新导出 excel 表格的信息\n\n        Object.assign(this.excelQueryVo, this.inOrderQueryVo);\n        this.excelPage = this.page;\n        this.excelLimit = this.limit;\n      });\n    },\n\n    handleSizeChange(limit) {\n      // 页数发生变化\n      this.limit = limit;\n      this.pageFind();\n    },\n\n    handleCurrentChange(page) {\n      // 当前页发生变化\n      this.page = page;\n      this.pageFind();\n    },\n\n    deleteInOrder(inOrder) {\n      // 删除入库记录\n      this.$confirm('此操作将永久删除[' + inOrder.id + ']入库订单信息, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        inOrderApi.deleteById(inOrder.id).then(resp => {\n          if (resp.data.code == 200) {\n            this.pageFind();\n          } else {\n            this.$message.error('服务器开了点小差！');\n          }\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n\n    showDetailOrder(detailOrder) {\n      // 展示入库订单详细信息\n      Object.assign(this.detailOrder, detailOrder);\n      this.detailOrderVisible = true;\n    },\n\n    exportExcel() {\n      // 将选中的数据进行导出\n      if (this.total == 0) {\n        this.$message.error('当前条件下表格数据为空！');\n        return;\n      }\n\n      this.$confirm('此操作将导出' + this.total + '条数据, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        // 处理响应 自动将响应结果下载\n        inOrderApi.exportInOrder(this.excelQueryVo).then(resp => {\n          const link = document.createElement(\"a\");\n          let blob = new Blob([resp.data], {\n            type: \"multipary/form-data\"\n          });\n          link.style.display = \"none\";\n          link.href = URL.createObjectURL(blob);\n          link.setAttribute(\"download\", decodeURI('入库订单表.xlsx'));\n          document.body.appendChild(link);\n          link.click();\n          document.body.removeChild(link);\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消数据导出'\n        });\n      });\n    },\n\n    exportCurrentExcel() {\n      // 导出当前页表格的信息\n      if (this.inOrderList.length == 0) {\n        this.$message.error('当前页不含数据！');\n        return;\n      }\n\n      this.$confirm('此操作将导出当前页的数据, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        inOrderApi.exportCurrentInOrder(this.excelPage, this.excelLimit, this.excelQueryVo).then(resp => {\n          const link = document.createElement(\"a\");\n          let blob = new Blob([resp.data], {\n            type: \"multipary/form-data\"\n          });\n          link.style.display = \"none\";\n          link.href = URL.createObjectURL(blob);\n          link.setAttribute(\"download\", decodeURI('入库订单表.xlsx'));\n          document.body.appendChild(link);\n          link.click();\n          document.body.removeChild(link);\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消数据导出'\n        });\n      });\n    },\n\n    listAdmin() {\n      // 通过角色获取所有管理员的信息\n      adminApi.listAdmin().then(resp => {\n        console.log(resp.data);\n        this.adminList.push({\n          id: null,\n          name: '全部',\n          username: '全部'\n        });\n        resp.data.forEach(a => {\n          this.adminList.push(a);\n        });\n      });\n    },\n\n    listGoods() {\n      goodsApi.listGoods().then(resp => {\n        this.goodsList.push({\n          id: null,\n          name: '全部'\n        });\n        resp.data.data.forEach(g => {\n          this.goodsList.push(g);\n        });\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAoJA;AACA;AACA;AAEA;EACAA,eADA;;EAEAC;IACA;MACAC,eADA;MAEAC,OAFA;MAGAC,QAHA;MAIAC,QAJA;MAKAC;QAAA;QACAC,aADA;QAEAC,aAFA;QAGAC,aAHA;QAIAC;MAJA,CALA;MAWAC;QAAA;QACAJ,aADA;QAEAC,aAFA;QAGAC,aAHA;QAIAC;MAJA,CAXA;MAiBAE,YAjBA;MAkBAC,aAlBA;MAmBAC;QACAC,MADA;QAEAR,WAFA;QAGAS,SAHA;QAIAC,UAJA;QAKAC,aALA;QAMAC,OANA;QAOAC,iBAPA;QAQAZ;MARA,CAnBA;MA6BAa,yBA7BA;MA8BAC,aA9BA;MA+BAC;IA/BA;EAiCA,CApCA;;EAqCAC;IACA;IACA;IACA;EACA,CAzCA;;EA0CAC;IACAC;MAAA;MACA;MACA,0CAFA,CAIA;;MACA;QACA;QACA;;QACA;UACA;UACA;QACA;MACA,CAZA,CAcA;;;MACAC;QACA;QACA,kCAFA,CAIA;;QACAC;QACA;QACA;MACA,CARA;IASA,CAzBA;;IA0BAC;MAAA;MACA;MACA;IACA,CA7BA;;IA8BAC;MAAA;MACA;MACA;IACA,CAjCA;;IAkCAC;MAAA;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA;QACAR;UACA;YACA;UACA,CAFA,MAEA;YACA;UACA;QACA,CANA;MAOA,CAZA,EAYAS,KAZA,CAYA;QACA;UACAF,YADA;UAEAG;QAFA;MAIA,CAjBA;IAkBA,CArDA;;IAsDAC;MAAA;MACAV;MACA;IACA,CAzDA;;IA0DAW;MAAA;MACA;QACA;QACA;MACA;;MACA;QACAP,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA;QACA;QACAR;UACA;UACA;YAAAO;UAAA;UACAM;UACAA;UACAA;UACAC;UACAD;UACAC;QACA,CATA;MAUA,CAhBA,EAgBAL,KAhBA,CAgBA;QACA;UACAF,YADA;UAEAG;QAFA;MAIA,CArBA;IAsBA,CArFA;;IAsFAK;MAAA;MACA;QACA;QACA;MACA;;MACA;QACAV,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA;QACAR,gCACA,cADA,EACA,eADA,EAEA,iBAFA,EAEAQ,IAFA,CAEAQ;UACA;UACA;YAAAT;UAAA;UACAM;UACAA;UACAA;UACAC;UACAD;UACAC;QACA,CAXA;MAYA,CAjBA,EAiBAL,KAjBA,CAiBA;QACA;UACAF,YADA;UAEAG;QAFA;MAIA,CAtBA;IAuBA,CAlHA;;IAmHAO;MAAA;MACAC;QACAC;QACA;UAAA/B;UAAAf;UAAA+C;QAAA;QACAJ;UACA;QACA,CAFA;MAGA,CANA;IAOA,CA3HA;;IA4HAK;MACAC;QACA;UAAAlC;UAAAf;QAAA;QACA2C;UACA;QACA,CAFA;MAGA,CALA;IAMA;;EAnIA;AA1CA","names":["name","data","inOrderList","page","limit","total","inOrderQueryVo","goodsId","adminId","timeStart","timeEnd","excelQueryVo","excelPage","excelLimit","detailOrder","id","number","inTime","goodsName","img","adminUsername","detailOrderVisible","adminList","goodsList","created","methods","pageFind","inOrderApi","Object","handleSizeChange","handleCurrentChange","deleteInOrder","confirmButtonText","cancelButtonText","type","then","catch","message","showDetailOrder","exportExcel","link","document","exportCurrentExcel","resp","listAdmin","adminApi","console","username","listGoods","goodsApi"],"sourceRoot":"src/views/warehouse","sources":["InOrder.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"in-order-header\">\r\n            <div>\r\n                <div class=\"in-order-search\">\r\n                    <el-select v-model=\"inOrderQueryVo.goodsId\" placeholder=\"请选择\">\r\n                        <el-option\r\n                                v-for=\"item in goodsList\"\r\n                                :key=\"item.id\"\r\n                                :label=\"item.name\"\r\n                                :value=\"item.id\">\r\n                        </el-option>\r\n                    </el-select>\r\n                </div>\r\n                <div class=\"in-order-search\">\r\n                    <el-select v-model=\"inOrderQueryVo.adminId\" placeholder=\"请选择\">\r\n                        <el-option\r\n                                v-for=\"item in adminList\"\r\n                                :key=\"item.id\"\r\n                                :label=\"item.username\"\r\n                                :value=\"item.id\">\r\n                        </el-option>\r\n                    </el-select>\r\n                </div>\r\n                <div class=\"in-order-search\">\r\n                    <el-date-picker\r\n                            v-model=\"inOrderQueryVo.timeStart\"\r\n                            type=\"datetime\"\r\n                            placeholder=\"起始日期\">\r\n                    </el-date-picker>\r\n                </div>\r\n                <div class=\"in-order-search\">\r\n                    <el-date-picker\r\n                            v-model=\"inOrderQueryVo.timeEnd\"\r\n                            type=\"datetime\"\r\n                            placeholder=\"截至日期\">\r\n                    </el-date-picker>\r\n                </div>\r\n                <div class=\"in-order-search\">\r\n                    <el-button type=\"success\" icon=\"el-icon-search\" plain @click=\"pageFind\"></el-button>\r\n                </div>\r\n                <div class=\"in-order-search\">\r\n                    <el-button type=\"info\" plain @click=\"exportExcel\">导出表格</el-button>\r\n                </div>\r\n                <div class=\"in-order-search\">\r\n                    <el-button type=\"info\" plain @click=\"exportCurrentExcel\">导出当前表格</el-button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"in-order-body\">\r\n            <template>\r\n                <el-table\r\n                        :data=\"inOrderList\"\r\n                        stripe\r\n                        height=\"700px\"\r\n                        style=\"width: 100%\">\r\n                    <el-table-column\r\n                            label=\"图片\"\r\n                            width=\"120%\">\r\n                        <template slot-scope=\"scope\">\r\n                            <el-image\r\n                                    style=\"width: 100px; height: 100px\"\r\n                                    :src=\"scope.row.img\">\r\n                            </el-image>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"inTime\"\r\n                            label=\"进货时间\"\r\n                            width=\"220%\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"goodsName\"\r\n                            label=\"商品名称\"\r\n                            width=\"180%\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"id\"\r\n                            label=\"订单编号\"\r\n                            width=\"220%\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"adminUsername\"\r\n                            label=\"负责人\"\r\n                            width=\"180\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"number\"\r\n                            label=\"数量\"\r\n                            width=\"180\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            label=\"操作\"\r\n                            width=\"300\">\r\n                        <template slot-scope=\"scope\">\r\n                            <el-button type=\"primary\" plain @click=\"showDetailOrder(scope.row)\">详情</el-button>\r\n                            <el-button type=\"danger\" plain @click=\"deleteInOrder(scope.row)\">删除</el-button>\r\n                        </template>\r\n                    </el-table-column>\r\n                </el-table>\r\n            </template>\r\n        </div>\r\n\r\n        <div>\r\n            <div class=\"block\">\r\n                <el-pagination\r\n                        @size-change=\"handleSizeChange\"\r\n                        @current-change=\"handleCurrentChange\"\r\n                        :page-sizes=\"[5, 10, 15, 20]\"\r\n                        :page-size=\"5\"\r\n                        layout=\"total, sizes, prev, pager, next, jumper\"\r\n                        :total=\"total\">\r\n                </el-pagination>\r\n            </div>\r\n        </div>\r\n\r\n\r\n        <div>\r\n            <el-dialog :visible.sync=\"detailOrderVisible\">\r\n                <el-descriptions title=\"商品信息\">\r\n                    <el-descriptions-item label=\"图片\">\r\n                        <el-image style=\"width: 100px; height: 100px\" :src=\"detailOrder.img\"></el-image>\r\n                    </el-descriptions-item>\r\n                    <el-descriptions-item label=\"订单编号\">{{detailOrder.id}}</el-descriptions-item>\r\n                    <el-descriptions-item label=\"商品编号\">{{detailOrder.goodsId}}</el-descriptions-item>\r\n                    <el-descriptions-item label=\"商品名称\">{{detailOrder.goodsName}}</el-descriptions-item>\r\n                    <el-descriptions-item label=\"数量\">\r\n                        <el-tag type=\"success\" size=\"small\">{{detailOrder.number}}</el-tag>\r\n                    </el-descriptions-item>\r\n                    <el-descriptions-item label=\"入库时间\">\r\n                        <el-tag type=\"success\" size=\"small\">{{detailOrder.inTime}}</el-tag>\r\n                    </el-descriptions-item>\r\n                    <el-descriptions-item label=\"负责人\">\r\n                        <el-tag size=\"small\">{{detailOrder.adminUsername}}</el-tag>\r\n                    </el-descriptions-item>\r\n                    <el-descriptions-item label=\"负责人编号\">{{detailOrder.adminId}}</el-descriptions-item>\r\n                </el-descriptions>\r\n                <div slot=\"footer\" class=\"dialog-footer\">\r\n                    <el-button @click=\"detailOrderVisible = false\">关 闭</el-button>\r\n                </div>\r\n            </el-dialog>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n\r\n    import inOrderApi from '@/api/warehouse/InOrderApi'\r\n    import adminApi from '@/api/admin/Admin'\r\n    import goodsApi from '@/api/warehouse/GoodsApi'\r\n\r\n    export default {\r\n        name: \"InOrder\",\r\n        data() {\r\n            return {\r\n                inOrderList: [],\r\n                page: 1,\r\n                limit: 5,\r\n                total: 0,\r\n                inOrderQueryVo: {  // 查询条件对象\r\n                    goodsId: null,\r\n                    adminId: null,\r\n                    timeStart: '',\r\n                    timeEnd: ''\r\n                },\r\n                excelQueryVo: {   // 导出文件时条件查询对象\r\n                    goodsId: null,\r\n                    adminId: null,\r\n                    timeStart: '',\r\n                    timeEnd: ''\r\n                },\r\n                excelPage: 1,\r\n                excelLimit: 5,\r\n                detailOrder: {\r\n                    id: '',\r\n                    goodsId: '',\r\n                    number: 0,\r\n                    inTime: '',\r\n                    goodsName: '',\r\n                    img: '',\r\n                    adminUsername: '',\r\n                    adminId: ''\r\n                },\r\n                detailOrderVisible: false,\r\n                adminList: [],\r\n                goodsList: []\r\n            }\r\n        },\r\n        created() {\r\n            this.pageFind()\r\n            this.listAdmin()\r\n            this.listGoods()\r\n        },\r\n        methods: {\r\n            pageFind() {   // 分页条件查找商品信息\r\n                let timeStart = this.inOrderQueryVo.timeStart\r\n                let timeEnd = this.inOrderQueryVo.timeEnd\r\n\r\n                // 检查时间条件是否合格\r\n                if (timeStart && timeEnd) {\r\n                    let start = new Date(timeStart)\r\n                    let end = new Date(timeEnd)\r\n                    if (start > end) {\r\n                        this.$message.error('时间范围错误！')\r\n                        return\r\n                    }\r\n                }\r\n\r\n                // 得到结果 填充数据\r\n                inOrderApi.pageFind(this.page, this.limit, this.inOrderQueryVo).then(resp => {\r\n                    this.inOrderList = resp.data.data.data\r\n                    this.total = resp.data.data.total\r\n\r\n                    // 更新导出 excel 表格的信息\r\n                    Object.assign(this.excelQueryVo, this.inOrderQueryVo)\r\n                    this.excelPage = this.page\r\n                    this.excelLimit = this.limit\r\n                })\r\n            },\r\n            handleSizeChange(limit) {  // 页数发生变化\r\n                this.limit = limit\r\n                this.pageFind()\r\n            },\r\n            handleCurrentChange(page) {  // 当前页发生变化\r\n                this.page = page\r\n                this.pageFind()\r\n            },\r\n            deleteInOrder(inOrder) {  // 删除入库记录\r\n                this.$confirm('此操作将永久删除[' + inOrder.id + ']入库订单信息, 是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    inOrderApi.deleteById(inOrder.id).then(resp => {\r\n                        if (resp.data.code == 200) {\r\n                            this.pageFind()\r\n                        } else {\r\n                            this.$message.error('服务器开了点小差！')\r\n                        }\r\n                    })\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消删除'\r\n                    })\r\n                })\r\n            },\r\n            showDetailOrder(detailOrder) {  // 展示入库订单详细信息\r\n                Object.assign(this.detailOrder, detailOrder)\r\n                this.detailOrderVisible = true\r\n            },\r\n            exportExcel() {  // 将选中的数据进行导出\r\n                if (this.total == 0) {\r\n                    this.$message.error('当前条件下表格数据为空！')\r\n                    return\r\n                }\r\n                this.$confirm('此操作将导出' + this.total + '条数据, 是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    // 处理响应 自动将响应结果下载\r\n                    inOrderApi.exportInOrder(this.excelQueryVo).then(resp => {\r\n                        const link = document.createElement(\"a\")\r\n                        let blob = new Blob([resp.data], {type: \"multipary/form-data\"})\r\n                        link.style.display = \"none\"\r\n                        link.href = URL.createObjectURL(blob)\r\n                        link.setAttribute(\"download\", decodeURI('入库订单表.xlsx'))\r\n                        document.body.appendChild(link)\r\n                        link.click()\r\n                        document.body.removeChild(link)\r\n                    })\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消数据导出'\r\n                    })\r\n                })\r\n            },\r\n            exportCurrentExcel() {  // 导出当前页表格的信息\r\n                if (this.inOrderList.length == 0) {\r\n                    this.$message.error('当前页不含数据！')\r\n                    return\r\n                }\r\n                this.$confirm('此操作将导出当前页的数据, 是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    inOrderApi.exportCurrentInOrder(\r\n                        this.excelPage, this.excelLimit,\r\n                        this.excelQueryVo).then(resp => {\r\n                        const link = document.createElement(\"a\")\r\n                        let blob = new Blob([resp.data], {type: \"multipary/form-data\"})\r\n                        link.style.display = \"none\"\r\n                        link.href = URL.createObjectURL(blob)\r\n                        link.setAttribute(\"download\", decodeURI('入库订单表.xlsx'))\r\n                        document.body.appendChild(link)\r\n                        link.click()\r\n                        document.body.removeChild(link)\r\n                    })\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消数据导出'\r\n                    })\r\n                })\r\n            },\r\n            listAdmin() {  // 通过角色获取所有管理员的信息\r\n                adminApi.listAdmin().then(resp => {\r\n                    console.log(resp.data)\r\n                    this.adminList.push({id: null, name: '全部', username: '全部'})\r\n                    resp.data.forEach(a => {\r\n                        this.adminList.push(a)\r\n                    })\r\n                })\r\n            },\r\n            listGoods() {\r\n                goodsApi.listGoods().then(resp => {\r\n                    this.goodsList.push({id: null, name: '全部'})\r\n                    resp.data.data.forEach(g => {\r\n                        this.goodsList.push(g)\r\n                    })\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n    .in-order-body {\r\n        width: 100%;\r\n        height: 700px;\r\n    }\r\n\r\n    .in-order-header {\r\n        height: 70px;\r\n    }\r\n\r\n    .in-order-header > div {\r\n        float: left;\r\n        padding-right: 50px;\r\n    }\r\n\r\n    .in-order-search {\r\n        float: left;\r\n        padding-left: 5px;\r\n    }\r\n\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}